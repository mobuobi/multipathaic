% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multipathaic.R
\name{plausible_models}
\alias{plausible_models}
\title{Select Plausible and Stable Models from Multi-Path AIC Search}
\usage{
plausible_models(forest, pi = NULL, Delta = 2, tau = 0.6, verbose = TRUE)
}
\arguments{
\item{forest}{A result object from `build_paths()`, containing `all_models`.}

\item{pi}{Optional named vector of per-variable stability values
(from `stability()$pi`). Default: `NULL`.}

\item{Delta}{AIC tolerance \eqn{\Delta} defining the plausible region.
Models with AIC ≤ (best AIC + Delta) are kept. Default: `2`.}

\item{tau}{Minimum average model stability \eqn{\tau} required to retain
a model (if stability scores supplied). Default: `0.6`.}

\item{verbose}{Logical. If TRUE, prints detailed progress and summaries. Default: TRUE.}
}
\value{
A list containing:
\describe{
  \item{plausible_models}{Data frame of plausible (and optionally stable) models.}
  \item{inclusion}{Named vector of variable inclusion probabilities.}
  \item{summary}{Data frame combining stability and inclusion probabilities.}
  \item{Delta}{The AIC tolerance used.}
  \item{tau}{The stability threshold used.}
  \item{best_aic}{The best (minimum) AIC observed.}
}
}
\description{
This function implements *Algorithm 3* of the multi-path AIC procedure.
It filters the full model set created by `build_paths()`
using two criteria:

\enumerate{
  \item \strong{AIC Plausibility}:
        Keep all models whose AIC is within \eqn{\Delta} of the best AIC.
  \item \strong{Stability Threshold} (optional):
        If variable stability scores are supplied (from `stability()`),
        then models whose average stability is below \eqn{\tau} are removed.
}

The function also computes variable inclusion probabilities across all
remaining plausible models.
}
\details{
After AIC filtering (Steps 1–3), the function optionally applies a stability filter
(Steps 4–5).
For each plausible model, the "average stability" is computed as:

\deqn{ \text{avg\_stability}(M) = \frac{1}{|M|} \sum_{v \in M} \pi_v }

If `pi = NULL`, the stability-based filtering is skipped.

The function also calculates variable inclusion probabilities across all
final plausible models (Step 6). Variables appearing in all models are marked
with no indicator; those appearing in only a subset are marked with `"(-)"`.
}
\examples{
## Complete pipeline example
set.seed(123)
n <- 120; p <- 6
X <- as.data.frame(matrix(rnorm(n*p), n, p))
names(X) <- paste0("x", 1:p)
beta <- c(2, -1, 0, 0, 1, 0)
y <- as.numeric(as.matrix(X) \%*\% beta + rnorm(n))

# Algorithm 1: multi-path forward selection
forest <- build_paths(X, y, family = "gaussian", K = 6, verbose = FALSE)

# Algorithm 2: variable stability
stab <- stability(X, y, family = "gaussian", B = 20, verbose = FALSE)

# Algorithm 3: plausible models
plaus <- plausible_models(
  forest = forest,
  pi = stab$pi,
  Delta = 2,
  tau = 0.6,
  verbose = TRUE
)

}
