% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multipathaic.R
\name{stability}
\alias{stability}
\title{Stability Estimation via Resampled Multi-Path Forward Selection}
\usage{
stability(
  X,
  y,
  family = c("gaussian", "binomial"),
  K = min(ncol(X), 10),
  eps = 1e-06,
  delta = 2,
  L = 100,
  B = 100,
  resample_fraction = 0.8,
  verbose = TRUE
)
}
\arguments{
\item{X}{A data frame or matrix of predictors.}

\item{y}{A numeric outcome vector for `gaussian`, or 0/1 for `binomial`.}

\item{family}{Model family, either `"gaussian"` (linear) or `"binomial"` (logistic).}

\item{K}{Maximum number of forward-selection steps in each resample.
Default: \code{min(ncol(X), 10)}.}

\item{eps}{Minimum AIC improvement required for a parent model
to expand. Default: `1e-6`.}

\item{delta}{AIC tolerance controlling which near-best models are kept. Default: 2.}

\item{L}{Maximum number of child models kept at each step. Default: 100.}

\item{B}{Number of resamples for stability estimation. Default: 100.}

\item{resample_fraction}{Fraction of the dataset used per resample
(bootstrap or subsample). Default: `0.8`.}

\item{verbose}{Logical. If TRUE, prints progress for each resample. Default: TRUE.}
}
\value{
A list with:
\describe{
  \item{pi}{Named vector of stability scores, sorted decreasing.}
  \item{pi_sum}{Running sum used to compute pi (for diagnostic purposes).}
  \item{B}{Number of completed resample iterations.}
  \item{call}{The matched function call.}
}
}
\description{
Computes variable-selection stability by repeatedly resampling the data
and applying the `build_paths()` algorithm.

For each bootstrap or subsample replicate, the function runs the
multi-path forward-selection search, extracts the variables appearing in the
final step of the search path, and computes the proportion of models containing
each variable (z_j^(b)). The stability score is the average of these proportions
across all resamples.

Stability is defined as:
\deqn{ \pi_j = \frac{1}{B} \sum_{b=1}^{B} z_j^{(b)} }
where z_j^(b) is the proportion of models in resample b that contain variable j.
}
\details{
Each resampled dataset is fit using the same multi-path forward-selection
procedure as in Algorithm 1. For each resample, the proportion of models
containing each variable is computed (z_j^(b)), and these proportions are
averaged across all B resamples to obtain the final stability scores (pi_j).

When a resample fails (e.g., due to singularities), it is skipped with a warning.
}
\examples{
## Linear regression example
set.seed(123)
n <- 150; p <- 10
X <- as.data.frame(matrix(rnorm(n*p), n, p))
names(X) <- paste0("x", 1:p)
beta <- c(2, -1.5, 0, 0, 1, rep(0, p-5))
y <- as.numeric(as.matrix(X) \%*\% beta + rnorm(n, 1))

stab <- stability(
  X, y,
  family = "gaussian",
  K = 10,
  B = 50,
  verbose = TRUE
)

## Logistic regression example
set.seed(1)
n <- 200; p <- 10
X <- as.data.frame(matrix(rnorm(n*p), n, p))
names(X) <- paste0("x", 1:p)
eta <- 1.5*X$x1 - 2*X$x2 + 1*X$x5
prob <- 1/(1 + exp(-eta))
y <- rbinom(n, 1, prob)

stab <- stability(
  X, y,
  family = "binomial",
  K = 8,
  B = 100,
  verbose = TRUE
)

}
